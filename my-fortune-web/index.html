<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life K-Line Pro | å¤©å‘½é‡‘ç·šçµ‚ç«¯</title>
    <style>
        :root { --gold: #f0b90b; --bg: #0b0e11; --card: #161a1e; --border: #2b2f36; --text-main: #eaecef; --text-dim: #848e9c; --green: #0ecb81; --red: #f6465d; }
        body { background: var(--bg); color: var(--text-main); font-family: -apple-system, 'PingFang TC', sans-serif; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 500px; box-sizing: border-box; }
        
        /* å»£å‘Šå®¹å™¨å„ªåŒ– */
        .ad-wrapper { width: 100%; margin: 15px 0; background: #0d1117; border-radius: 4px; min-height: 80px; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 1px solid var(--border); position: relative; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin: 10px 0; }
        .header h2 { font-size: 18px; color: var(--gold); margin: 0; font-weight: 900; letter-spacing: 1px; }
        .lang-btn { background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 5px 12px; border-radius: 4px; font-size: 11px; cursor: pointer; }
        
        .dashboard { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
        .stat-box { background: var(--card); border: 1px solid var(--border); padding: 12px 5px; border-radius: 4px; text-align: center; border-top: 2px solid var(--gold); }
        .stat-label { font-size: 10px; color: var(--text-dim); margin-bottom: 4px; }
        .stat-value { font-size: 13px; color: var(--gold); font-weight: bold; }
        
        .input-grid { display: flex; gap: 10px; margin-bottom: 15px; }
        input { background: #1e2329; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 6px; font-size: 16px; width: 100%; box-sizing: border-box; text-align: center; outline: none; }
        
        #main-btn { width: 100%; background: var(--gold); color: #000; border: none; padding: 18px; border-radius: 6px; font-weight: 800; font-size: 16px; cursor: pointer; position: relative; z-index: 100; }
        
        #canvasWrap { width: 100%; height: 320px; background: #0b0e11; border: 1px solid var(--border); position: relative; border-radius: 4px; margin-top: 15px; overflow: hidden; }
        canvas { position: absolute; top: 0; left: 0; width: 100% !important; height: 100% !important; z-index: 10; }
        
        #tooltip { position: absolute; display: none; background: rgba(30,35,41,0.95); border: 1px solid var(--gold); padding: 8px; border-radius: 4px; font-size: 11px; z-index: 1001; pointer-events: none; color: white; white-space: nowrap; }
        
        #shareArea { display: none; margin-top: 20px; border: 1px solid var(--border); padding: 25px; border-radius: 6px; background: #161a1e; border-left: 6px solid var(--gold); }
        #shareText { font-size: 14px; line-height: 1.8; color: var(--text-main); white-space: pre-wrap; text-align: justify; }
        
        .action-grid { display: none; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; width: 100%; }
        .social-grid { display: none; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; width: 100%; }
        
        .btn { padding: 15px; border-radius: 6px; border: none; font-weight: bold; cursor: pointer; font-size: 12px; display: flex; align-items: center; justify-content: center; text-decoration: none; }
        .btn-gold { background: var(--gold); color: #000; }
        .btn-dark { background: #2b2f36; color: #fff; }
        .btn-social { background: #1e2329; color: var(--text-dim); border: 1px solid var(--border); font-size: 10px; }
        
        footer { margin-top: 40px; font-size: 11px; color: var(--text-dim); text-align: center; border-top: 1px solid var(--border); padding: 25px 0; width: 100%; }
        .p-link { text-decoration: underline; cursor: pointer; margin-top: 8px; display: inline-block; }
        #p-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; max-height: 70%; background: #1e2329; border: 1px solid var(--gold); padding: 20px; z-index: 5000; border-radius: 8px; overflow-y: auto; color: #eaecef; }
        .highlight { color: var(--gold); font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <div class="ad-wrapper">
            <iframe data-aa='2422219' src='//acceptable.a-ads.com/2422219/?size=Adaptive' style="width:100%;height:60px;border:0;"></iframe>
        </div>

        <div class="header">
            <h2 id="t-title">LIFE K-LINE PRO</h2>
            <button class="lang-btn" id="lang-btn">EN/ä¸­æ–‡</button>
        </div>

        <div class="dashboard">
            <div class="stat-box"><div class="stat-label" id="t-l1">æ ¼å±€</div><div class="stat-value" id="val-gz">--</div></div>
            <div class="stat-box"><div class="stat-label" id="t-l2">ä¸»æ˜Ÿ</div><div class="stat-value" id="val-star">--</div></div>
            <div class="stat-box"><div class="stat-label" id="t-l3">äº”è¡Œ</div><div class="stat-value" id="val-na">--</div></div>
        </div>

        <div class="input-grid">
            <input type="number" id="year" placeholder="YYYY" inputmode="numeric">
            <input type="number" id="month" placeholder="MM" inputmode="numeric">
            <input type="number" id="day" placeholder="DD" inputmode="numeric">
        </div>

        <button id="main-btn">è§£ç¢¼äº¤æ˜“å¤©å‘½æ•¸æ“šæµ</button>
        
        <div id="canvasWrap">
            <div id="tooltip"></div>
            <canvas id="kCanvas"></canvas>
        </div>

        <div class="ad-wrapper">
            <div id="container-1c8414512642a1d6a9a357721384a36c">
                <script async="async" data-cfasync="false" src="https://pl28346647.effectivegatecpm.com/1c8414512642a1d6a9a357721384a36c/invoke.js"></script>
            </div>
        </div>

        <div id="shareArea"><div id="shareText"></div></div>

        <div class="action-grid" id="action-grid">
            <button class="btn btn-gold" id="save-btn">ğŸ“¸ ä¿å­˜å¸¶æ°´å°æˆªåœ–</button>
            <button class="btn btn-dark" id="copy-btn">ğŸ“‹ è¤‡è£½å°ˆå®¶ç ”å ±</button>
        </div>

        <div class="social-grid" id="social-grid">
            <a href="#" class="btn btn-social" id="share-wa">WhatsApp</a>
            <a href="#" class="btn btn-social" id="share-tg">Telegram</a>
            <a href="#" class="btn btn-social" id="share-x">Twitter / X</a>
        </div>

        <footer>
            <p id="t-disclaim">æœ¬ç³»çµ±åƒ…ä¾›å¨›æ¨‚åƒè€ƒï¼Œäº¤æ˜“æœ‰é¢¨éšªï¼ŒæŠ•è³‡éœ€è¬¹æ…ã€‚æ•¸æ“šæ¨¡å‹åŸºæ–¼ç®—æ³•ç”Ÿæˆã€‚</p>
            <p>Â© 2025 LuckyFortune Terminal</p>
            <span class="p-link" id="t-privacy" onclick="toggleP(true)">Privacy Policy</span>
        </footer>
    </div>

    <div id="p-modal">
        <div style="text-align:right; cursor:pointer; color:var(--gold); font-weight:bold;" onclick="toggleP(false)">[CLOSE]</div>
        <div id="p-content"></div>
    </div>

<script>
(function() {
    let curLang = 'zh';
    let kData = [];
    const TG = ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"];
    const DZ = ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"];
    
    const canvas = document.getElementById('kCanvas');
    const ctx = canvas.getContext('2d');
    const tooltip = document.getElementById('tooltip');

    const i18n = {
        zh: {
            title: "LIFE K-LINE PRO", l1: "æ ¼å±€", l2: "ä¸»æ˜Ÿ", l3: "äº”è¡Œ", btn: "è§£ç¢¼äº¤æ˜“å¤©å‘½æ•¸æ“šæµ",
            save: "ğŸ“¸ ä¿å­˜å¸¶æ°´å°æˆªåœ–", copy: "ğŸ“‹ è¤‡è£½å°ˆå®¶ç ”å ±",
            disclaim: "æœ¬ç³»çµ±åƒ…ä¾›å¨›æ¨‚åƒè€ƒï¼Œäº¤æ˜“æœ‰é¢¨éšªï¼ŒæŠ•è³‡éœ€è¬¹æ…ã€‚æ•¸æ“šæ¨¡å‹åŸºæ–¼ç®—æ³•ç”Ÿæˆï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°ã€‚",
            privacy: "éš±ç§æ”¿ç­–èˆ‡æœå‹™æ¢æ¬¾", water: "Life K-Line Pro | äº¤æ˜“å¤©å‘½",
            modal: "<b>éš±ç§æ”¿ç­–:</b> æˆ‘å€‘ä¸æ”¶é›†ä»»ä½•æ‚¨çš„å‡ºç”Ÿæ—¥æœŸæ•¸æ“šã€‚ç¬¬ä¸‰æ–¹å»£å‘Šï¼ˆAdsterraï¼‰å¯èƒ½æœƒä½¿ç”¨ Cookie ä»¥æä¾›å»£å‘Šã€‚",
            stars: ["ç´«å¾®", "å¤©æ©Ÿ", "å¤ªé™½", "æ­¦æ›²", "å¤©åŒ", "å»‰è²", "å¤©åºœ", "å¤ªé™°", "è²ªç‹¼", "å·¨é–€", "å¤©ç›¸", "å¤©æ¢", "ä¸ƒæ®º", "ç ´è»"],
            na: ["æµ·ä¸­é‡‘", "å¤§æºªæ°´", "å¤©ä¸Šç«", "è·¯æ—åœŸ", "å¤§æ—æœ¨"],
            types: ["è„ˆè¡å¼æˆé•·", "èºæ—‹å¼ä¸Šå‡", "éšæ¢¯å¼èºé·", "å¹¾ä½•ç´šçˆ†ç™¼", "åè½‰å¼è§¸åº•", "ç®±é«”éœ‡ç›ªå‹", "é•·ç·šæ…¢ç‰›å‹", "æ¥µç«¯æ³¢å¹…å‹"],
            signs: ["é›™ç¥¿äº¤æµ", "é­é‰å¤¾å‘½", "æ—¥æœˆä¸¦æ˜", "ä¸‰å¥‡åŠ æœƒ", "ç´«åºœåŒå®®", "é‡‘ç‡¦å…‰è¼"],
            advice_core: [
                "ç­–ç•¥ï¼šåˆ©ç”¨è·¨é€±æœŸå‡ç·šä¿®æ­£æƒ…ç·’åå·®ï¼Œåœ¨ä¸»å‡æµªæœŸé–“å …å®šæŒå€‰ã€‚",
                "å»ºè­°ï¼šå¸‚å ´ææ‡¼æ™‚æ‡‰é€†å‘æ€è€ƒï¼Œæœ¬å‘½æ ¼åˆ©æ–¼åœ¨æ¥µç«¯å›æ’¤ä¸­å»ºç«‹å¤šé ­é ­å¯¸ã€‚",
                "å¿ƒæ³•ï¼šçŸ¥å‘½è€Œä¸ä¿¡å‘½ï¼Œæ‰€æœ‰çš„Kç·šæ³¢å‹•çš†æ˜¯èªçŸ¥çš„è®Šç¾ï¼Œéœ€åš´æ ¼åŸ·è¡Œæ­¢ç›ˆç­–ç•¥ã€‚"
            ],
            patterns: [
                "å¤©ç›¤é¡¯ç¤ºã€Œ{sign}ã€ä¹‹å¥‡å…†ï¼Œé€™æ„å‘³è‘—è³‡ç”¢æ·¨å€¼åœ¨é•·ç·šé€±æœŸå…§å…·æœ‰æ¥µå¼·çš„ä¿®å¾©èƒ½åŠ›ï¼Œé©åˆè·¨é€±æœŸä½ˆå±€ã€‚",
                "å‘½ç›¤èˆ‡ç•¶å‰å¤§è¶¨å‹¢ç”¢ç”Ÿå¼·çƒˆå…±æŒ¯ï¼Œé¡¯ç¤ºå‡ºã€Œ{type}ã€çš„ç¨ç‰¹è·¯å¾‘ï¼Œæ—©æœŸé›–æœ‰éœ‡ç›ªä½†ä¸­å¾ŒæœŸå¾Œå‹åè¶³ã€‚",
                "è§€å¯Ÿå…¶èƒ½é‡åˆ†å¸ƒï¼Œä¸»æ˜Ÿã€Œ{star}ã€æ•£ç™¼å‡ºå¼·å¤§çš„äº¤æ˜“ç›´è¦ºï¼Œå°¤å…¶åœ¨è·¨è¶Šé—œéµå¿ƒç†é˜»åŠ›ä½æ™‚è¡¨ç¾å“è¶Šã€‚"
            ]
        },
        en: {
            title: "LIFE K-LINE PRO", l1: "PILLAR", l2: "STAR", l3: "ELEMENT", btn: "DECODE DESTINY DATA",
            save: "ğŸ“¸ SAVE SCREENSHOT", copy: "ğŸ“‹ COPY REPORT",
            disclaim: "For entertainment only. Trading involves risk. Models are algorithmically generated.",
            privacy: "Privacy Policy & Terms", water: "Life K-Line Pro | Trading Destiny",
            modal: "<b>Privacy Policy:</b> We do not store personal info. 3rd-party ads (Adsterra) may use cookies.",
            stars: ["ZiWei", "TianJi", "Sun", "WuQu", "TianTong", "LianZhen", "TianFu", "Moon", "TanLang", "JuMen", "TianXiang", "TianLiang", "QiSha", "PoJun"],
            na: ["Ocean Gold", "Stream Water", "Heaven Fire", "Road Earth", "Forest Wood"],
            types: ["Pulsed Growth", "Spiral Ascent", "Step Transition", "Geometric Blast", "V-Shape Bottom", "Box Oscillation", "Slow Bull", "High Volatility"],
            signs: ["Double Wealth", "Elite Alignment", "Sun-Moon Harmony", "Triple Fortune", "Imperial Palace", "Golden Glow"],
            advice_core: [
                "Strategy: Use cross-cycle averages to correct bias and hold firm during surges.",
                "Advice: Think contrarily when market fears; your pillar favors long positions in extreme dips.",
                "Heart: Destiny is awareness; every K-line move is your mind reflecting in the market volatility."
            ],
            patterns: [
                "The '{sign}' omen suggests your net worth has high resilience in long-term cycles with strong recovery.",
                "Strong resonance with current trends indicates a '{type}' path with potential long-term momentum.",
                "Main star '{star}' radiates strong intuition, especially when breaking through key psychological resistance."
            ]
        }
    };

    function updateUI() {
        const t = i18n[curLang];
        document.getElementById('t-title').innerText = t.title;
        document.getElementById('t-l1').innerText = t.l1;
        document.getElementById('t-l2').innerText = t.l2;
        document.getElementById('t-l3').innerText = t.l3;
        document.getElementById('main-btn').innerText = t.btn;
        document.getElementById('save-btn').innerText = t.save;
        document.getElementById('copy-btn').innerText = t.copy;
        document.getElementById('t-disclaim').innerText = t.disclaim;
        document.getElementById('t-privacy').innerText = t.privacy;
        document.getElementById('p-content').innerHTML = t.modal;
    }

    function draw() {
        const y = parseInt(document.getElementById('year').value);
        const m = parseInt(document.getElementById('month').value);
        const d = parseInt(document.getElementById('day').value);
        if (!y || !m || !d) return;

        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * dpr; canvas.height = rect.height * dpr;
        ctx.scale(dpr, dpr);
        const w = rect.width, h = rect.height;

        ctx.fillStyle = "#0b0e11"; ctx.fillRect(0, 0, w, h);

        let curY = h * 0.5; kData = [];
        let peakY = y, peakV = 999;
        let valleyY = y, valleyV = -999;

        for (let i = 0; i < 50; i++) {
            const cy = y + i;
            const seed = Math.abs(Math.sin(cy * y + m * 55 + d * 88));
            let move = (seed - 0.5) * 60;
            move -= (curY - h/2) * 0.22; // å¼·åŠ›å›å½ˆç®—æ³•ï¼Œç¢ºä¿Kç·šä¸å‡ºæ ¼

            const open = curY; const close = curY + move;
            const x = 40 + i * ((w - 70) / 50);
            kData.push({ x, open, close, year: cy, change: ((open-close)/open*100).toFixed(2) });

            ctx.strokeStyle = ctx.fillStyle = (close < open) ? "#0ecb81" : "#f6465d";
            ctx.beginPath(); ctx.moveTo(x, open); ctx.lineTo(x, close); ctx.lineWidth = 2; ctx.stroke();
            if (i % 10 === 0) { ctx.fillStyle = "#474d57"; ctx.font = "10px monospace"; ctx.fillText(cy, x - 12, h - 10); }
            if (close < peakV) { peakV = close; peakY = cy; }
            if (close > valleyV) { valleyV = close; valleyY = cy; }
            curY = close;
        }

        const t = i18n[curLang];
        const sIdx = (y + m + d) % 14;
        const tIdx = (y * m + d) % 8;
        const siIdx = (y + d) % 6;
        const aIdx = (y + m + d) % 3;
        const pIdx = (y * d) % 3;

        const star = t.stars[sIdx];
        const type = t.types[tIdx];
        const gz = TG[(y - 4) % 10] + DZ[(y - 4) % 12];
        const na = t.na[y % 5];
        const sign = t.signs[siIdx];

        document.getElementById('val-gz').innerText = gz;
        document.getElementById('val-star').innerText = star;
        document.getElementById('val-na').innerText = na;

        const ptn = t.patterns[pIdx].replace("{sign}", sign).replace("{type}", type).replace("{star}", star);
        const resPeak = curLang === 'zh' ? `äººç”Ÿè³‡ç”¢ä¸»å‡æµªé è¨ˆåœ¨ <span class='highlight'>${peakY}å¹´</span> åˆ°é”å·”å³°ã€‚` : `Wealth peak surge expected in <span class='highlight'>${peakY}</span>.`;
        const resRisk = curLang === 'zh' ? `éœ€æ³¨æ„é€±æœŸæ€§æ³¢å‹•ï¼Œåœ¨ <span class='highlight'>${y + (m%15)}å¹´</span> å‰å¾Œä¿æŒç¾é‡‘æµå½ˆæ€§ã€‚` : `Maintain liquidity around <span class='highlight'>${y + (m%15)}</span>.`;
        
        const fullReport = `ğŸ“Š ${curLang=='zh'?'ã€å¤©å‘½é‡‘ç·šäº¤æ˜“ç ”å ±ã€‘':'[TRADE DESTINY REPORT]'}\n\n` + 
                         `1ï¸âƒ£ ã€æ ¸å¿ƒæ ¼å±€ã€‘\næœ¬å‘½ã€Œ${gz}ã€ï¼Œç´éŸ³ã€Œ${na}ã€ã€‚æ¨¡å‹ã€Œ${type}ã€ï¼Œä¸»æ˜Ÿã€Œ${star}ã€ã€‚${ptn}\n\n` +
                         `2ï¸âƒ£ ã€æ³¢æ®µé æ¸¬ã€‘\n${resPeak} ${resRisk}\n\n` +
                         `3ï¸âƒ£ ã€äº¤æ˜“ç­–ç•¥ã€‘\n${t.advice_core[aIdx]}\n\n` +
                         `ğŸ“ LuckyFortune Terminal - Professional Edition`;

        document.getElementById('shareText').innerHTML = fullReport.replace(/\n/g, "<br>");
        document.getElementById('shareArea').style.display = 'block';
        document.getElementById('action-grid').style.display = 'grid';
        document.getElementById('social-grid').style.display = 'grid';

        const shareUrl = window.location.href;
        const shareMsg = encodeURIComponent(fullReport + "\nCheck yours: " + shareUrl);
        document.getElementById('share-wa').href = `https://wa.me/?text=${shareMsg}`;
        document.getElementById('share-tg').href = `https://t.me/share/url?url=${shareUrl}&text=${shareMsg}`;
        document.getElementById('share-x').href = `https://twitter.com/intent/tweet?text=${shareMsg}`;
    }

    // äº¤äº’æç¤º
    canvas.addEventListener('mousemove', (e) => {
        if (!kData.length) return;
        const rect = canvas.getBoundingClientRect();
        const mx = e.clientX - rect.left;
        const p = kData.reduce((prev, curr) => Math.abs(curr.x - mx) < Math.abs(prev.x - mx) ? curr : prev);
        if (Math.abs(p.x - mx) < 10) {
            tooltip.style.display = 'block'; tooltip.style.left = (mx + 15) + 'px'; tooltip.style.top = (p.close - 20) + 'px';
            const color = p.close < p.open ? '#0ecb81' : '#f6465d';
            tooltip.innerHTML = `<b>${p.year}</b><br><span style="color:${color}">${p.change > 0 ? 'â–²' : 'â–¼'} ${Math.abs(p.change)}%</span>`;
        } else { tooltip.style.display = 'none'; }
    });

    document.getElementById('main-btn').addEventListener('click', draw);
    document.getElementById('lang-btn').addEventListener('click', () => { curLang = curLang === 'zh' ? 'en' : 'zh'; updateUI(); if(kData.length) draw(); });
    document.getElementById('copy-btn').addEventListener('click', () => {
        const tempDiv = document.createElement("div"); tempDiv.innerHTML = document.getElementById('shareText').innerHTML;
        navigator.clipboard.writeText(tempDiv.innerText).then(() => alert(curLang=='zh'?"ç ”å ±å·²è¤‡è£½":"Report Copied"));
    });

    document.getElementById('save-btn').addEventListener('click', () => {
        const temp = document.createElement('canvas'); const tCtx = temp.getContext('2d');
        const dpr = window.devicePixelRatio || 1;
        temp.width = canvas.width; temp.height = canvas.height;
        tCtx.drawImage(canvas, 0, 0);
        tCtx.fillStyle = "rgba(240,185,11,0.5)"; tCtx.font = "bold 18px Arial"; tCtx.textAlign="right";
        tCtx.fillText(i18n[curLang].water, (temp.width/dpr)-15, (temp.height/dpr)-40);
        const a = document.createElement('a'); a.download=`Life_KLine.png`; a.href=temp.toDataURL(); a.click();
    });

    window.toggleP = (show) => { document.getElementById('p-modal').style.display = show ? 'block' : 'none'; };
    updateUI();
})();
</script>
</body>
</html>