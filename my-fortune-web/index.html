<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life K-Line Pro Terminal</title>
    <style>
        :root { 
            --gold: #f0b90b; 
            --bg: #0b0e11; 
            --card: #161a1e; 
            --border: #2b2f36;
            --text-main: #eaecef;
            --text-dim: #848e9c;
            --green: #0ecb81; 
            --red: #f6465d; 
        }
        body { 
            background: var(--bg); color: var(--text-main); 
            font-family: "PingFang SC", "Helvetica Neue", sans-serif; 
            margin: 0; padding: 15px; 
            display: flex; flex-direction: column; align-items: center; 
        }
        .container { width: 100%; max-width: 500px; box-sizing: border-box; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; width: 100%; }
        .header h2 { font-size: 16px; color: var(--gold); margin: 0; letter-spacing: 2px; }

        .input-grid { display: flex; gap: 8px; margin-bottom: 12px; }
        input { 
            background: #1e2329; border: 1px solid var(--border); 
            color: white; padding: 12px; border-radius: 4px; 
            font-size: 14px; outline: none; flex: 1; min-width: 0;
        }
        
        #main-btn { 
            width: 100%; background: var(--gold); color: #000; 
            border: none; padding: 16px; border-radius: 4px; 
            font-weight: bold; cursor: pointer; font-size: 15px; 
            margin-bottom: 20px; transition: opacity 0.2s;
        }

        #canvasWrap { 
            width: 100%; height: 320px; 
            background: #0b0e11; border: 1px solid var(--border); 
            position: relative; border-radius: 4px; overflow: hidden;
        }
        canvas { display: block; width: 100%; height: 100%; }
        
        #tooltip { 
            position: absolute; display: none; background: rgba(30, 35, 41, 0.98); 
            border: 1px solid var(--gold); padding: 10px; border-radius: 4px; 
            font-size: 12px; z-index: 100; pointer-events: none; width: 160px;
        }

        #shareArea { 
            display: none; margin-top: 20px; border: 1px solid var(--border); 
            padding: 20px; border-radius: 4px; background: #161a1e;
        }
        #shareText { font-size: 13px; line-height: 1.8; color: var(--text-main); white-space: pre-wrap; }

        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; display: none; }
        .share-btn { background: #2b2f36; color: white; border: none; padding: 12px; font-size: 12px; border-radius: 4px; cursor: pointer; }
        .btn-gold { background: var(--gold); color: #000; font-weight: bold; }

        .lang-btn {
            background: none; border: 1px solid var(--gold); color: var(--gold);
            padding: 4px 10px; border-radius: 2px; font-size: 10px; cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="header">
        <h2 id="t-title">LIFE K-LINE TERMINAL</h2>
        <button id="lang-btn" class="lang-btn">EN / ä¸­æ–‡</button>
    </div>

    <div class="container">
        <div class="input-grid">
            <input type="number" id="year" placeholder="Year">
            <input type="number" id="month" placeholder="Mon">
            <input type="number" id="day" placeholder="Day">
        </div>
        <button id="main-btn">GENERATE DESTINY REPORT</button>
        
        <div id="canvasWrap">
            <div id="tooltip"></div>
            <canvas id="kCanvas"></canvas>
        </div>

        <div id="shareArea">
            <div id="shareText"></div>
        </div>

        <div class="action-grid" id="action-grid">
            <button class="share-btn btn-gold" id="save-btn">SAVE CHART</button>
            <button class="share-btn" id="copy-btn">COPY REPORT</button>
            <button class="share-btn" id="x-btn">X (TWITTER)</button>
            <button class="share-btn" id="fb-btn">FACEBOOK</button>
        </div>
    </div>

<script>
(function() {
    let currentLang = 'en';
    let cachedData = [];

    const advicePool = {
        en: [
            "Your golden era starts from {year}, prioritize aggressive expansion.",
            "Focus on compounding assets rather than short-term gains.",
            "Mid-term volatility expected, keep 30% liquidity ready.",
            "A major trend reversal occurs in your 40sâ€”stay adaptable.",
            "Strategy: Buy the dips in personal growth, sell the hype in vanity.",
            "Avoid high-leverage emotional decisions during low-tide years.",
            "Wealth will flow through social networks; invest in high-value circles.",
            "Defensive play is recommended between ages 35 and 42.",
            "Focus on 'Infinite Games'â€”long-term skills outlast market luck.",
            "Your peak energy aligns with {year}, perfect for career pivots.",
            "Health is your hidden margin; don't trade it for marginal gains.",
            "Identify your 'Personal Monopoly'â€”the skill only you can scale.",
            "Volatility is not risk; it is the price of admission for growth.",
            "Cut losses on toxic relationships as fast as a bad stock trade.",
            "The best hedge against inflation is your own earning capacity.",
            "Market noise is temporary; your core philosophy is permanent.",
            "Diversify your identity so one failure doesn't bankrupt your soul.",
            "Master the art of 'Deep Work' to stay ahead in an AI-driven era.",
            "Every crisis in your chart is a discounted opportunity to reinvent.",
            "Stay humble at the peaks; stay solvent at the troughs.",
            "Time is the only asset that cannot be re-bought; spend it on high ROI tasks.",
            "Learn to sellâ€”whether a product or an idea, it's a foundational power.",
            "Your network is your net worth; cultivate it with genuine value.",
            "Optimization is for the small; Strategy is for the big.",
            "Seek asymmetric bets where the downside is limited and upside is infinite.",
            "Do not confuse luck with skill during a bull market phase.",
            "The most expensive thing you can own is a closed mind.",
            "Build systems, not just goals; systems produce repeatable success.",
            "Retirement is a financial number, not a biological age.",
            "Keep your overhead low and your curiosity high."
        ],
        zh: [
            "ä½ çš„é»ƒé‡‘é€±æœŸå°‡åœ¨ {year} å¹´é–‹å•Ÿï¼Œæ­¤æ™‚æ‡‰å…¨åŠ›å‡ºæ“Šã€‚",
            "30æ­²å‰æ³¨é‡è³‡ç”¢ç©ç´¯è€Œéžæ¶ˆè²»ï¼Œåˆ©ç”¨æ™‚é–“è¤‡åˆ©å®ŒæˆåŽŸå§‹ç©ç´¯ã€‚",
            "è­¦æƒ•ä¸­å¹´éœ‡ç›ªæœŸï¼Œå»ºè­°ä¿æŒ 30% çš„ç¾é‡‘æµä»¥æ‡‰å°çªç™¼è®Šå‹•ã€‚",
            "40æ­²å·¦å³å°‡è¿Žä¾†é—œéµçš„è³½é“åˆ‡æ›é»žï¼Œä¿æŒå­¸ç¿’åŠ›æ˜¯æ ¸å¿ƒç«¶çˆ­åŠ›ã€‚",
            "æŠ•è³‡ç­–ç•¥ï¼šåœ¨ä½Žè°·æœŸæŠ•è³‡è‡ªæˆ‘ï¼Œåœ¨é«˜é»žæœŸå­¸æœƒå®ˆæˆã€‚",
            "é¿å…åœ¨æƒ…ç·’ä½Žæ½®æœŸåšå‡ºé«˜æ§“æ¡¿çš„äººç”Ÿæ„ç¾©æ±ºç­–ã€‚",
            "è²¡å¯Œå°‡é€šéŽç¤¾äº¤æ§“æ¡¿æ”¾å¤§ï¼Œè«‹å‹™å¿…æŠ•è³‡é«˜åƒ¹å€¼çš„äººè„ˆåœˆã€‚",
            "ä½ çš„èƒ½é‡å·”å³°èˆ‡ {year} å¹´é‡åˆï¼Œé©åˆåœ¨æ­¤æœŸé–“é€²è¡Œå¤§è†½è½‰åž‹ã€‚",
            "35-42æ­²ä¹‹é–“å»ºè­°æŽ¡å–é˜²ç¦¦åž‹ç­–ç•¥ï¼Œå®ˆä½æ ¸å¿ƒè³‡ç”¢ï¼Œæ¸›å°‘æ¿€é€²å†’éšªã€‚",
            "é—œæ³¨ã€Œç„¡é™éŠæˆ²ã€â€”â€”é•·æœŸæŠ€èƒ½çš„åƒ¹å€¼å°‡é è¶…çŸ­æœŸçš„å¸‚å ´é‹æ°£ã€‚",
            "å¥åº·æ˜¯ä½ çš„éš±å½¢é‚Šéš›æˆæœ¬ï¼Œä¸è¦ç‚ºäº†å¾®å°çš„å¢žé‡æ”¶ç›Šè€Œé€æ”¯å®ƒã€‚",
            "å°‹æ‰¾ä½ çš„ã€Œå€‹äººå£Ÿæ–·ã€â€”â€”å»ºç«‹é‚£ç¨®åªæœ‰ä½ èƒ½å¤§è¦æ¨¡æä¾›çš„åƒ¹å€¼ã€‚",
            "æ³¢å‹•ä¸ç­‰æ–¼é¢¨éšªï¼Œå®ƒæ˜¯ç²å¾—è¶…é¡æˆé•·å¿…é ˆæ”¯ä»˜çš„é–€ç¥¨ã€‚",
            "æžœæ–·æ­¢ææœ‰å®³ç¤¾äº¤ï¼Œå°±åƒåœ¨äº¤æ˜“ä¸­è¿…é€Ÿåˆ‡æ–·è™§æé ­å¯¸ä¸€æ¨£é‡è¦ã€‚",
            "å°æŠ—é€šè†¨çš„æœ€ä½³å°æ²–å·¥å…·æ˜¯ä½ æŒçºŒé€²åŒ–çš„è³ºéŒ¢èƒ½åŠ›ã€‚",
            "å¸‚å ´å™ªéŸ³æ˜¯æš«æ™‚çš„ï¼Œä½†ä½ çš„åº•å±¤åƒ¹å€¼é‚è¼¯æ‡‰è©²æ˜¯æ°¸ä¹…çš„ã€‚",
            "å°‡èº«ä»½æ¨™ç±¤å¤šå…ƒåŒ–ï¼Œé€™æ¨£å–®ä¸€çš„å¤±æ•—å°±ä¸æœƒå°Žè‡´éˆé­‚ç ´ç”¢ã€‚",
            "åœ¨ AI æ™‚ä»£ï¼Œæ·±åº¦å·¥ä½œçš„èƒ½åŠ›å°‡æˆç‚ºä½ æœ€ç¨€ç¼ºçš„è³‡ç”¢ã€‚",
            "K ç·šä¸­çš„æ¯ä¸€æ¬¡ä½Žè°·ï¼Œéƒ½æ˜¯ä¸€æ¬¡æ‰“æŠ˜é‡å¡‘è‡ªæˆ‘çš„æ©Ÿæœƒã€‚",
            "å·”å³°æ™‚ä¿æŒè¬™å‘ï¼Œä½Žè°·æ™‚ä¿æŒæµå‹•æ€§ï¼ˆä¿¡å¿ƒèˆ‡ç¾é‡‘ï¼‰ã€‚",
            "æ™‚é–“æ˜¯å”¯ä¸€ç„¡æ³•å›žè³¼çš„è³‡ç”¢ï¼Œå°‡å…¶èŠ±åœ¨æœ€é«˜å›žå ±çŽ‡çš„äº‹æƒ…ä¸Šã€‚",
            "å­¸æœƒã€ŒéŠ·å”®ã€â€”â€”ç„¡è«–æ˜¯æŽ¨éŠ·ç”¢å“é‚„æ˜¯ç†å¿µï¼Œé€™æ˜¯åº•å±¤çš„æ¬ŠåŠ›ã€‚",
            "ä½ çš„åœˆå­æ±ºå®šä½ çš„æ·¨å€¼ï¼Œç”¨çœŸå¯¦çš„åƒ¹å€¼åŽ»æ¾†çŒäººéš›ç¶²çµ¡ã€‚",
            "å¼±è€…å¿™æ–¼å„ªåŒ–ç´°ç¯€ï¼Œå¼·è€…å°ˆæ³¨æ–¼èª¿æ•´å®è§€ç­–ç•¥ã€‚",
            "å°‹æ‰¾ä¸å°ç¨±æ©Ÿæœƒï¼šè™§ææœ‰é™ä½†æ½›åœ¨æ”¶ç›Šç„¡é™çš„åšå¼ˆã€‚",
            "åœ¨ç‰›å¸‚é€±æœŸä¸­ï¼Œåƒè¬ä¸è¦æŠŠé‹æ°£èª¤èªç‚ºæ˜¯è‡ªå·±çš„å¯¦åŠ›ã€‚",
            "ä½ æ“æœ‰çš„æœ€æ˜‚è²´çš„æ±è¥¿æ˜¯ä¸€å€‹å°é–‰çš„å¤§è…¦ã€‚",
            "å»ºç«‹ç³»çµ±è€Œéžåƒ…åƒ…ç›¯è‘—ç›®æ¨™ï¼Œç³»çµ±èƒ½ç”¢ç”Ÿå¯é‡ç¾çš„æˆåŠŸã€‚",
            "é€€ä¼‘æ˜¯ä¸€å€‹è²¡å‹™æ•¸å­—ï¼Œè€Œä¸æ˜¯ä¸€å€‹ç”Ÿç†å¹´é½¡ã€‚",
            "ä¿æŒä½Žæˆæœ¬çš„ç”Ÿæ´»é–‹æ”¯ï¼Œä»¥åŠé«˜æˆæœ¬çš„å¥½å¥‡å¿ƒã€‚"
        ]
    };

    const i18n = {
        en: {
            yP: "Year", mP: "Mon", dP: "Day", btn: "GENERATE DESTINY REPORT",
            change: "Change", tags: ["BULL SURGE", "ACCUMULATION", "RISING STAR", "REVERSAL"],
            reportTitle: "ðŸ“Š [DESTINY ANALYSIS REPORT]",
            labelStatus: "âœ¨ STATUS", labelPeak: "ðŸš€ PEAK MOMENT", labelGrowth: "ðŸ“ˆ TOTAL POTENTIAL", labelAdv: "ðŸ’¡ ADVISORY",
            analysis: [{ k: "Buy", d: "Luck is soaring." }, { k: "Hold", d: "Compounding phase." }, { k: "Consolidate", d: "Energy gathering." }, { k: "Risk", d: "Turbulence." }, { k: "Rebound", d: "Bottom is in." }, { k: "Breakout", d: "Sky is limit." }]
        },
        zh: {
            yP: "å‡ºç”Ÿå¹´", mP: "æœˆ", dP: "æ—¥", btn: "ç”Ÿæˆç”Ÿå‘½å ±å‘Š",
            change: "ç´¯è¨ˆå¢žå¹…", tags: ["è³‡ç”¢ä¸»å‡æµª", "åº•éƒ¨æ½›ä¼æœŸ", "æˆé•·å•Ÿæ˜Žæ˜Ÿ", "å‘½é‹åè½‰é»ž"],
            reportTitle: "ðŸ“Š ã€ç”Ÿå‘½è³‡ç”¢ K ç·šæ·±åº¦å ±å‘Šã€‘",
            labelStatus: "âœ¨ æ ¸å¿ƒç‹€æ…‹", labelPeak: "ðŸš€ è²¡å¯Œå·”å³°", labelGrowth: "ðŸ“ˆ ç´¯è¨ˆæ½›èƒ½", labelAdv: "ðŸ’¡ å°ˆå®¶å»ºè­°",
            analysis: [{ k: "å¼·åŠ›è²·å…¥", d: "é‹å‹¢å¦‚è™¹ã€‚" }, { k: "æŒå€‰ä¸å‹•", d: "ç©©æ­¥ä¸Šå‡ã€‚" }, { k: "å€é–“éœ‡ç›ª", d: "è“„å‹¢éšŽæ®µã€‚" }, { k: "æ¸›å€‰é¿éšª", d: "é«˜æ³¢å‹•å¹´ã€‚" }, { k: "è§¸åº•åå½ˆ", d: "é»Žæ˜Žå°‡è‡³ã€‚" }, { k: "å‘ä¸Šçªç ´", d: "äººç”Ÿèºé·ã€‚" }]
        }
    };

    function mulberry32(a) {
        return function() {
            var t = a += 0x6D2B79F5;
            t = Math.imul(t ^ t >>> 15, t | 1);
            t ^= t + Math.imul(t ^ t >>> 7, t | 61);
            return ((t ^ t >>> 14) >>> 0) / 4294967296;
        }
    }

    function getDynamicAdvice(seed, lang, year) {
        const pool = [...advicePool[lang]];
        let rand = mulberry32(seed);
        for (let i = pool.length - 1; i > 0; i--) {
            const j = Math.floor(rand() * (i + 1));
            [pool[i], pool[j]] = [pool[j], pool[i]];
        }
        return pool.slice(0, 6).map((txt, i) => `${i+1}. ${txt.replace("{year}", year)}`).join('\n');
    }

    const canvas = document.getElementById('kCanvas');
    const ctx = canvas.getContext('2d');
    const tooltip = document.getElementById('tooltip');

    function draw() {
        const yVal = document.getElementById('year').value;
        if (!yVal) return;
        const birthYear = parseInt(yVal);
        const seed = birthYear + (parseInt(document.getElementById('month').value)||1)*31 + (parseInt(document.getElementById('day').value)||1);
        const random = mulberry32(seed);

        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * dpr; canvas.height = rect.height * dpr;
        ctx.scale(dpr, dpr);

        const w = rect.width, h = rect.height;
        const pad = { top: 20, right: 10, bottom: 30, left: 10 };
        const cW = w - pad.left - pad.right, cH = h - pad.top - pad.bottom;

        ctx.fillStyle = "#0b0e11"; ctx.fillRect(0,0,w,h);
        ctx.strokeStyle = "#1e2329";
        for(let i=0; i<=4; i++) {
            let gy = pad.top + (cH/4)*i;
            ctx.beginPath(); ctx.moveTo(0, gy); ctx.lineTo(w, gy); ctx.stroke();
        }

        let curY = cH * 0.65;
        let peakYear = birthYear, maxUp = -999;
        cachedData = [];

        for (let i = 0; i < 40; i++) {
            const x = pad.left + i * (cW / 40) + (cW / 80);
            const move = Math.sin(seed * 0.1 + i * 0.7) * 12 + (random() - 0.5) * 40;
            const open = curY, close = curY - move;
            const dO = Math.min(Math.max(open, 0), cH) + pad.top;
            const dC = Math.min(Math.max(close, 0), cH) + pad.top;
            cachedData.push({ x, open: dO, close: dC, year: birthYear + i, aIdx: Math.floor(random()*6) });
            const isUp = close < open;
            ctx.strokeStyle = ctx.fillStyle = isUp ? "#0ecb81" : "#f6465d";
            ctx.beginPath(); ctx.moveTo(x, dO-random()*10); ctx.lineTo(x, dC+random()*10); ctx.stroke();
            ctx.fillRect(x - (cW/40)*0.3, Math.min(dO, dC), (cW/40)*0.6, Math.abs(dO - dC) + 1);
            if ((birthYear + i) % 5 === 0) {
                ctx.fillStyle = "#474d57"; ctx.font = "10px monospace"; ctx.textAlign = "center";
                ctx.fillText(birthYear + i, x, h - 10);
            }
            if (isUp && (open-close) > maxUp) { maxUp = open-close; peakYear = birthYear + i; }
            curY = close;
        }

        const baseO = cachedData[0].open;
        const totalChange = Math.abs((((baseO - cachedData[39].close)/baseO)*100).toFixed(1));
        const lang = i18n[currentLang];
        const dynamicAdvice = getDynamicAdvice(seed, currentLang, peakYear);
        
        document.getElementById('shareText').innerText = `${lang.reportTitle}\n\n${lang.labelStatus}: ${lang.tags[seed % 4]}\n${lang.labelPeak}: ${peakYear}\n${lang.labelGrowth}: +${totalChange}%\n\n${lang.labelAdv}:\n${dynamicAdvice}`;
        document.getElementById('shareArea').style.display = 'block';
        document.getElementById('action-grid').style.display = 'grid';
    }

    canvas.addEventListener('mousemove', (e) => {
        if (!cachedData.length) return;
        const r = canvas.getBoundingClientRect();
        const mx = e.clientX - r.left;
        const close = cachedData.reduce((p, c) => Math.abs(c.x - mx) < Math.abs(p.x - mx) ? c : p);
        if (Math.abs(close.x - mx) < 15) {
            const info = i18n[currentLang].analysis[close.aIdx];
            tooltip.style.display = "block";
            tooltip.style.left = (close.x > r.width - 170 ? close.x - 175 : close.x + 10) + "px";
            tooltip.style.top = "20px";
            tooltip.innerHTML = `<b style="color:var(--gold)">${close.year} Â· ${info.k}</b><br><span style="color:#848e9c">${info.d}</span>`;
        } else { tooltip.style.display = "none"; }
    });

    document.getElementById('lang-btn').addEventListener('click', () => {
        currentLang = currentLang === 'en' ? 'zh' : 'en';
        const L = i18n[currentLang];
        document.getElementById('main-btn').innerText = L.btn;
        document.getElementById('year').placeholder = L.yP;
        document.getElementById('month').placeholder = L.mP;
        document.getElementById('day').placeholder = L.dP;
        if(cachedData.length) draw();
    });

    document.getElementById('main-btn').addEventListener('click', draw);
    document.getElementById('save-btn').addEventListener('click', () => {
        const link = document.createElement('a'); link.download = `LifeChart.png`; link.href = canvas.toDataURL(); link.click();
    });
    document.getElementById('copy-btn').addEventListener('click', () => {
        navigator.clipboard.writeText(document.getElementById('shareText').innerText); alert("Report Copied!");
    });
    document.getElementById('x-btn').addEventListener('click', () => {
        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(document.getElementById('shareText').innerText)}`);
    });
    document.getElementById('fb-btn').addEventListener('click', () => {
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`);
    });
})();
</script>
</body>
</html>